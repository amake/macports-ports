# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem 1.0
PortGroup           haskell_stack 1.0

name                DoCon
set shortname       docon
version             2.12
revision            0
categories          math devel
maintainers         nomaintainer
platforms           darwin

description         DoCon is the Algebraic Domain Constructor
long_description    \
        DoCon joins the categorial approach to mathematical \
        computation expressed via the Haskell type classes, \
        and explicit processing of the domain description \
        terms.  It implements recently a good piece of \
        commutative algebra: linear algebra, polynomial gcd, \
        factorization, Groebner bases, and other functions.

homepage            http://www.botik.ru/pub/local/Mechveliani/docon
master_sites        ${homepage}/${version}
distname            ${shortname}-${version}
use_zip             yes

checksums           md5     705ae5a6561d8fadddfddd3f8dfa00b4 \
                    rmd160  e324a679584d7a9ead1c69ebcb8a8fce44d0187f \
                    sha256  d43013c2dccd4b437c2673ba8f62aa55a785b41a01355d4b8a93459bb656faa9 \
                    size    1583274

patchfiles          patch-docon.cabal.diff

worksrcdir          ${shortname}/source

variant printable_doc description {Build printable documentation} {
    depends_build bin:latex:texlive port:ghostscript

    post-destroot {
        # Run latex twice to resolve references
        system "cd ${workpath}/${shortname} && latex manual.lat"
        system "cd ${workpath}/${shortname} && latex manual.lat"
        system "cd ${workpath}/${shortname} && dvipdf manual"
        file mkdir ${destroot}${prefix}/share/doc/${shortname}-${version}
        file copy ${workpath}/${shortname}/manual.pdf ${destroot}${prefix}/share/doc/${shortname}-${version}/
    }
}


post-destroot {
    file mkdir ${destroot}${prefix}/libexec/${shortname}-${version}
    file copy ${worksrcpath}/register.sh \
        ${destroot}${prefix}/libexec/${shortname}-${version}
    file copy ${worksrcpath}/unregister.sh \
        ${destroot}${prefix}/libexec/${shortname}-${version}
}

post-activate {
    system "${prefix}/libexec/${shortname}-${version}/register.sh"
}

livecheck.type      none
